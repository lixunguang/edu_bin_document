import{g as D,a as T,b as k,_ as O}from"./index.f3b0bd2a.js";/* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              */import{d as N,B as S,aD as I,a$ as R,bc as U,e as B,aG as u,aI as o,aM as w,aN as H,b2 as z,b3 as J,bJ as $,b8 as L,aH as j,C as G,be as W,aW as X,bm as K}from"./arco.be854816.js";import{f as Q}from"./vue.0bc632a1.js";/* empty css               *//* empty css              */import"./chart.cc2aed62.js";const M=N({__name:"index",props:{files:null,limit:null},emits:["add","delete"],setup(E,{emit:g}){const v=s=>{const{onProgress:m,onError:r,onSuccess:f,fileItem:y,name:e}=s,l=new XMLHttpRequest;l.upload&&(l.upload.onprogress=function(p){let d;p.total>0&&(d=p.loaded/p.total),m(d,p)}),l.onerror=function(d){r(d)},l.onload=function(){if(l.status<200||l.status>=300)return r(l.responseText);const d=JSON.parse(l.responseText);return g("add",d),f(l.response)};const i=new FormData,h=String(D());return i.append(e||"file",y.file),l.open("post","/admin/upload_files",!0),l.setRequestHeader("Authorization",h),l.send(i),{abort(){l.abort()}}},C=s=>{const{uid:m}=s;return g("delete",m),new Promise((r,f)=>{R.confirm({title:"on-before-remove",content:`\u786E\u8BA4\u5220\u9664 ${s.name}`,onOk:()=>r(!0)})})};return(s,m)=>{const r=U;return S(),I(r,{"custom-request":v,"file-list":E.files,limit:E.limit,onBeforeRemove:C},null,8,["file-list","limit"])}}}),Y=N({__name:"courseModal",emits:["refresh"],setup(E,{expose:g,emit:v}){const C=B("\u65B0\u589E\u4EFF\u771F\u8BFE\u7A0B"),s=B(!1),m=B(!1),r=T(),{login_id:f,user_id:y}=r,e=B({id:0,title:"",desc:"",author:f,bannerPic:[{uid:"111",url:"111",name:"111"}],bannerVideo:[{uid:"111",url:"111",name:"111"}]});e.value.bannerPic.splice(0,1),e.value.bannerVideo.splice(0,1);const l=()=>{s.value=!0,m.value=!0,e.value={id:0,title:"",desc:"",author:f,bannerPic:[],bannerVideo:[]}},i=async function(a){try{const n={id:a},t=await k.post("/admin/course",n);debugger;e.value.id=a,e.value.title=t.data.title,e.value.desc=t.data.desc,e.value.bannerPic=[],t.data.picture_url!==""&&e.value.bannerPic.push({uid:t.data.picture_id,name:t.data.picture_name,url:t.data.picture_url}),e.value.bannerVideo=[],t.data.vedio_url!==""&&e.value.bannerVideo.push({uid:t.data.vedio_id,name:t.data.vedio_name,url:t.data.vedio_url})}catch(n){throw console.log(n),n}},h=a=>{s.value=!0,m.value=!1,i(a)},p=async function(a){e.value.bannerPic.push({uid:a.data[0].id,name:a.data[0].url,url:a.data[0].full_url})},d=async function(a){const n=e.value.bannerPic;for(let t=0;t<n.length;t+=1)n[t].uid===a&&n.splice(t,1)},V=async function(a){e.value.bannerVideo.push({uid:a.data[0].id,name:a.data[0].url,url:a.data[0].full_url})},F=async function(a){const n=e.value.bannerVideo;for(let t=0;t<n.length;t+=1)n[t].uid===a&&n.splice(t,1)},A=async function(){var a,n,t,b;if(m.value)try{const c={title:e.value.title,desc:e.value.desc,author_id:Number(y),picture_id:Number((a=e.value.bannerPic[0])==null?void 0:a.uid),vedio_id:Number((n=e.value.bannerVideo[0])==null?void 0:n.uid)},P=await k.post("/admin/course/add",c);s.value=!1,v("refresh")}catch(c){throw console.log(c),c}else try{const c={course_id:e.value.id,title:e.value.title,desc:e.value.desc,author_id:Number(y),picture_id:Number((t=e.value.bannerPic[0])==null?void 0:t.uid),vedio_id:Number((b=e.value.bannerVideo[0])==null?void 0:b.uid)},P=await k.post("/admin/course/update",c)}catch(c){throw console.log(c),c}v("refresh")},_=()=>{s.value=!1};return g({showAdd:l,showEdit:h}),(a,n)=>{const t=z,b=J,c=$,P=L,q=R;return S(),I(q,{visible:s.value,"onUpdate:visible":n[2]||(n[2]=x=>s.value=x),width:"800px",title:C.value,onOk:A,onCancel:_},{default:u(()=>[o(P,{model:e.value,"auto-label-width":""},{default:u(()=>[o(b,{field:"title",label:"\u6807\u9898"},{default:u(()=>[o(t,{modelValue:e.value.title,"onUpdate:modelValue":n[0]||(n[0]=x=>e.value.title=x),placeholder:"please enter...",style:{width:"320px"}},null,8,["modelValue"])]),_:1}),o(b,{field:"desc",label:"\u63CF\u8FF0"},{default:u(()=>[o(t,{modelValue:e.value.desc,"onUpdate:modelValue":n[1]||(n[1]=x=>e.value.desc=x),placeholder:"please enter",style:{width:"320px"}},null,8,["modelValue"])]),_:1}),o(b,{field:"author",label:"\u4F5C\u8005"},{default:u(()=>[o(c,null,{default:u(()=>[w(H(e.value.author),1)]),_:1})]),_:1}),o(b,{field:"bannerPic",label:"\u5C01\u9762\u56FE"},{default:u(()=>[o(M,{files:e.value.bannerPic,limit:1,onAdd:p,onDelete:d},null,8,["files"])]),_:1}),o(b,{field:"bannerVideo",label:"\u5C01\u9762\u89C6\u9891"},{default:u(()=>[o(M,{files:e.value.bannerVideo,limit:1,onAdd:V,onDelete:F},null,8,["files"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])}}}),Z={class:"container"},ee=N({__name:"list",setup(E){const g=Q(),v=B(),C=(i,h)=>{g.push({name:i,params:{id:h}})},s={pageSize:10},m=[{title:"id",dataIndex:"id",width:100},{title:"\u540D\u79F0",dataIndex:"title",width:200},{title:"\u63CF\u8FF0",dataIndex:"desc"},{title:"\u4F5C\u8005",dataIndex:"author",width:100},{title:"\u9884\u89C8",slotName:"check",width:100},{title:"\u7F16\u8F91",slotName:"edit",width:100},{title:"\u7F16\u8F91\u7AE0\u8282",slotName:"editChapter",width:100},{title:"\u5220\u9664",slotName:"delete",width:100}],r=B([{id:1,title:"\u4EFF\u771F\u8BFE\u7A0B1",desc:"\u8BFE\u7A0B12322",author:"\u674E\u5148\u751F"}]),f=async function(){try{const i=await k.post("/admin/course/all");r.value=i.data}catch(i){throw console.log(i),i}};f();const y=async function(i){const h={id:i};await k.post("/admin/course/del",h),f()},e=()=>{v.value.showAdd()},l=i=>{v.value.showEdit(i)};return(i,h)=>{const p=j("Breadcrumb"),d=W,V=$,F=X,A=K;return S(),G("div",Z,[o(d,null,{default:u(()=>[o(p,{items:["menu.mSimu","menu.mSimu.list"]},null,8,["items"])]),_:1}),o(d,null,{default:u(()=>[o(V,null,{default:u(()=>[w(" \u8BFE\u7A0B\u5217\u8868\uFF1A ")]),_:1})]),_:1}),o(d,null,{default:u(()=>[o(F,{type:"primary",onClick:e},{default:u(()=>[w("\u65B0\u589E\u8BFE\u7A0B")]),_:1})]),_:1}),o(A,{columns:m,data:r.value,pagination:s},{check:u(({record:_})=>[o(F,{onClick:a=>C("SimuPre",_.id)},{default:u(()=>[w("\u9884\u89C8")]),_:2},1032,["onClick"])]),edit:u(({record:_})=>[o(F,{onClick:a=>l(Number(_.id))},{default:u(()=>[w("\u7F16\u8F91\u57FA\u672C\u4FE1\u606F")]),_:2},1032,["onClick"])]),editChapter:u(({record:_})=>[o(F,{onClick:a=>C("SimuChapterEdit",_.id)},{default:u(()=>[w("\u7F16\u8F91\u7AE0\u8282")]),_:2},1032,["onClick"])]),delete:u(({record:_})=>[o(F,{onClick:a=>i.$modal.info({title:"\u5220\u9664",content:_.id,onOk:()=>y(_.id)})},{default:u(()=>[w("\u5220\u9664")]),_:2},1032,["onClick"])]),_:1},8,["data"]),o(Y,{ref_key:"courseBasicModalRef",ref:v,onRefresh:f},null,512)])}}});const ve=O(ee,[["__scopeId","data-v-0c886c64"]]);export{ve as default};
