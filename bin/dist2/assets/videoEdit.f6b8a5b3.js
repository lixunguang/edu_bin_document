import{b as p,g as q,_ as N}from"./index.f3b0bd2a.js";/* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              */import{d as R,e as g,bc as C,b8 as E,C as F,F as b,aI as l,aG as _,aH as k,B as M,a$ as S,bh as I,b3 as D}from"./arco.be854816.js";import{f as H,h as T}from"./vue.0bc632a1.js";import"./chart.cc2aed62.js";const V={class:"container"},A=R({__name:"videoEdit",setup(O){H();const u=T(),h=g({}),a=g([]),c=async function(){try{const n={id:Number(u.params.id)},o=(await p.post("/admin/learning/resource",n)).data;if(o!=null&&o.length){a.value=[];for(let s=0;s<o.length;s+=1)a.value.push({uid:o[s].id,name:o[s].title,url:o[s].content_url})}else a.value=[]}catch(n){throw console.log(n),n}};c();const v=async function(n){try{const e={learning_id:Number(u.params.id),resource_id:n,index:a.value.length};debugger;const o=await p.post("/admin/learning/resource/add",e);c()}catch(e){throw console.log(e),e}},w=async function(n){try{const e={learning_id:Number(u.params.id),resource_id:n},o=await p.post("/admin/learning/resource/del",e);c()}catch(e){throw console.log(e),e}},x=n=>{const{onProgress:e,onError:o,onSuccess:s,fileItem:d,name:m}=n,t=new XMLHttpRequest;t.upload&&(t.upload.onprogress=function(i){let r;i.total>0&&(r=i.loaded/i.total),e(r,i)}),t.onerror=function(r){o(r)},t.onload=function(){if(t.status<200||t.status>=300)return o(t.responseText);const r=JSON.parse(t.responseText);return a.value.push({uid:r.data[0].id,name:r.data[0].url,url:r.data[0].full_url}),v(r.data[0].id),s(t.response)};const f=new FormData,B=String(q());return f.append(m||"file",d.file),t.open("post","/admin/upload_files",!0),t.setRequestHeader("Authorization",B),t.send(f),{abort(){t.abort()}}},y=n=>{const{uid:e}=n;return new Promise((o,s)=>{S.confirm({title:"on-before-remove",content:`\u786E\u8BA4\u5220\u9664 ${n.name}`,onOk:()=>w(Number(e))})})};return(n,e)=>{const o=k("Breadcrumb"),s=C,d=I,m=D,t=E;return M(),F("div",V,[b("div",null,[l(o,{items:["menu.mStudy","menu.mStudy.list"]},null,8,["items"])]),b("div",null,[l(t,{model:h.value,"auto-label-width":""},{default:_(()=>[l(m,{field:"title",label:"\u7F16\u8F91\u89C6\u9891"},{default:_(()=>[l(d,{span:8},{default:_(()=>[l(s,{"custom-request":x,"file-list":a.value,onBeforeRemove:y},null,8,["file-list"])]),_:1})]),_:1})]),_:1},8,["model"])])])}}});const K=N(A,[["__scopeId","data-v-13d519bf"]]);export{K as default};
